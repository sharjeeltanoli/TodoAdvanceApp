# Dapr Secrets Store Component â€” Kubernetes Secrets
# Docs: https://docs.dapr.io/reference/components-reference/supported-secret-stores/kubernetes-secret-store/
#
# Uses native Kubernetes secrets. No additional infrastructure needed.
# Other components reference secrets via secretKeyRef.

apiVersion: dapr.io/v1alpha1
kind: Component
metadata:
  name: {{SECRET_STORE_NAME|default:kubernetes}}
  namespace: {{NAMESPACE|default:default}}
spec:
  type: secretstores.kubernetes
  version: v1
  metadata: []
  # No additional config needed for K8s secrets store.
  # Dapr uses the pod's service account to access secrets.

---
# Example: Create the actual Kubernetes secret
# kubectl create secret generic db-credentials \
#   --from-literal=connection-string="host=... user=... password=... dbname=..." \
#   -n {{NAMESPACE}}

apiVersion: v1
kind: Secret
metadata:
  name: {{SECRET_NAME|default:app-secrets}}
  namespace: {{NAMESPACE|default:default}}
type: Opaque
stringData:
  # Database
  connection-string: "{{DB_CONNECTION_STRING|example:postgresql://user:pass@host:5432/db?sslmode=require}}"
  # OpenAI
  openai-api-key: "{{OPENAI_API_KEY|example:sk-...}}"
  # Auth
  better-auth-secret: "{{AUTH_SECRET|example:change-me-in-production}}"
